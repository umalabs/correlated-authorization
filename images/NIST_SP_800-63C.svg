<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="2167" height="1415"><desc>participant%20%22IdP%20%2B%20STS%22%20as%20IdP-STS%0Aparticipant%20%22Client%22%20as%20Client%0Aparticipant%20%22RP%22%20as%20RP%0A%0Abottomparticipants%0A%0Anote%20over%20IdP-STS%3AIdP%20%2B%20STS%3A%5Cn%E2%80%A2%20both%20act%20as%20the%20same%20authority%0Anote%20over%20Client%3AClient%3A%5Cn%E2%80%A2%20runs%20as%20a%20service%20with%20its%20own%20URI%5Cn%E2%80%A2%20client%20generates%20its%20own%20public%20and%20private%20key%20pair%20to%20sign%20assertions%20and%20authenticate%20to%20RPs%5Cn%E2%80%A2%20public%20keys%20are%20published%20at%20the%20clients%20well-known%20URI%5Cn%E2%80%A2%20client_id%20is%20the%20client%20URI%5Cn%E2%80%A2%20uses%20a%20JWT%20client%20authentication%20to%20authenticate%20to%20IdPs%20and%20RPs%5Cn%E2%80%A2%20acts%20as%20a%20Relying%20Party%20in%20respect%20of%20the%20IdP%20in%20order%20to%20obtain%20an%20access_token_with_user_claims%5Cn%E2%80%A2%20acts%20as%20an%20identity%20forwarder%20that%20forwards%20identity%20claims%20tokens%20from%20the%20IdP%20to%20the%20RP%0Anote%20over%20RP%3ARP%3A%5Cn%E2%80%A2%20is%20a%20resource%20server%20using%20the%20local%20ABAC%20engine%20to%20automate%20authorization%20assessment%0AClient-%3EClient%3A1.%20Client%20generates%20the%20resource_claims_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%7D%5Cn%20%20%20%20iss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20resource_claims_token%5Cn%20%20%20%20aud%20is%20the%20URI%20that%20identifies%20the%20requested%20resource%5Cn%20%20%20%20sub%20is%20the%20client_id%5Cn%20%20%20%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%0AIdP-STS%3C-Client%3A2.%20Request%20an%20identity_claims_token%20(token%20exchange%20request)%5Cn%20%20%20%20%7Bgrant_type%20%3D%20token-exchange%2C%5Cn%20%20%20%20%20requested_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%2C%5Cn%20%20%20%20%20subject_token%20%3D%20access_token_with_user_claims%2C%5Cn%20%20%20%20%20subject_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token%2C%5Cn%20%20%20%20%20actor_token%20%3D%20resource_claims_token%2C%5Cn%20%20%20%20%20actor_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%7D%5Cn%20%20%20%20and%20generate%20the%20authentication%20JWT%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20sub%2C%20aud%2C%20jti%2C%20exp%7D%5Cn%20%20%20%20iss%20is%20the%20client_id%5Cn%20%20%20%20aud%20is%20the%20URI%20that%20identifies%20the%20IdP%5Cn%20%20%20%20sub%20is%20the%20client_id%5Cn%20%20%20%20jti%2C%20exp%20are%20the%20standard%20JWT%20claims%0AIdP-STS-%3EIdP-STS%3A3.%20Authorization%20assessment%5Cn%20%20%20%201.%20verify%20the%20authentication%20token%20signature%20and%20evaluate%20the%20authentication%20claims%5Cn%20%20%20%202.%20verify%20the%20subject_token%20signature%20and%20evaluate%20the%20subject_token%20claims%5Cn%20%20%20%203.%20verify%20the%20resource_claims_token%20signature%20and%20evaluate%20the%20resource%20claims%20%0A%0AIdP-STS-%3EIdP-STS%3A4.%20STS%20generates%20the%20identity_claims_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20act%7Bsub%7D%7D%5Cn%20%20%20%20iss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20identity_claims_token%5Cn%20%20%20%20aud%20identifies%20the%20target%20service%20and%20it%20is%20the%20aud%20claim%20value%20extracted%20from%20the%20resource_claims_token%5Cn%20%20%20%20sub%20identifies%20the%20principal%20by%20email%20address%20and%20was%20extracted%20from%20the%20access_token_with_user_claims%5Cn%20%20%20%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20act%7Bsub%7D%20is%20the%20sub%20value%20extracted%20from%20the%20resource_claims_token%0AClient%3C-IdP-STS%3A5.%20Return%20the%20identity_claims_token%20in%20the%20access_token%20parameter%2C%5Cn%20%20%20%20issued_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%0A%0AClient-%3ERP%3A6.%20Send%20HTTP%20request%20to%20resource_uri%20with%20the%20identity_claims_token%2C%5Cn%20%20%20%20and%20generate%20the%20authentication%20JWT%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20sub%2C%20aud%2C%20jti%2C%20exp%7D%5Cn%20%20%20%20iss%20is%20the%20client_id%5Cn%20%20%20%20aud%20is%20the%20URI%20that%20identifies%20the%20requested%20resource%5Cn%20%20%20%20sub%20is%20the%20client_id%5Cn%20%20%20%20jti%2C%20exp%20are%20the%20standard%20JWT%20claims%0Aiss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20authentication%20token%0ARP-%3ERP%3A7.%20Authorization%20assessment%5Cn%20%20%20%201.%20verify%20the%20authentication%20token%20signature%20and%20evaluate%20the%20authentication%20claims%5Cn%20%20%20%202.%20verify%20the%20identity_claims_token%20signature%20and%20evaluate%20the%20identity%20claims%0ARP-%3EClient%3A8.%20Return%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="2167" height="1415"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 50.815047804 L 148.82443653175784 1362.657528204" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 963.3853137434767 50.815047804 L 963.3853137434767 1362.657528204" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1508.9783762423049 50.815047804 L 1508.9783762423049 1362.657528204" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 96.59743726328324 10.253481456000003 L 201.05143580023247 10.253481456000003 L 201.05143580023247 50.815047804 L 96.59743726328324 50.815047804 L 96.59743726328324 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.95777164528323" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 925.7749793614767 10.253481456000003 L 1000.9956481254767 10.253481456000003 L 1000.9956481254767 50.815047804 L 925.7749793614767 50.815047804 L 925.7749793614767 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="942.1353137434767" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1483.0930422417746 10.253481456000003 L 1534.8637102428352 10.253481456000003 L 1534.8637102428352 50.815047804 L 1483.0930422417746 50.815047804 L 1483.0930422417746 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1499.4533766237746" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 96.59743726328324 1362.657528204 L 201.05143580023247 1362.657528204 L 201.05143580023247 1403.2190945520001 L 96.59743726328324 1403.2190945520001 L 96.59743726328324 1362.657528204 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.95777164528323" y="1388.1404453520001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 925.7749793614767 1362.657528204 L 1000.9956481254767 1362.657528204 L 1000.9956481254767 1403.2190945520001 L 925.7749793614767 1403.2190945520001 L 925.7749793614767 1362.657528204 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="942.1353137434767" y="1388.1404453520001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1483.0930422417746 1362.657528204 L 1534.8637102428352 1362.657528204 L 1534.8637102428352 1403.2190945520001 L 1483.0930422417746 1403.2190945520001 L 1483.0930422417746 1362.657528204 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1499.4533766237746" y="1388.1404453520001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 80.97234620399999 L 276.5387641835157 80.97234620399999 L 290.1095484635157 94.54313048399999 L 290.1095484635157 130.731888564 L 7.5393246000000005 130.731888564 L 7.5393246000000005 80.97234620399999 M 276.5387641835157 80.97234620399999 L 276.5387641835157 94.54313048399999 L 290.1095484635157 94.54313048399999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.649433480000027" y="102.08245508399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.649433480000027" y="117.16110428399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• both act as the same authority</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 581.3668796681642 153.34986236400005 L 1331.8329635387893 153.34986236400005 L 1345.4037478187893 166.92064664400004 L 1345.4037478187893 293.58129992400006 L 581.3668796681642 293.58129992400006 L 581.3668796681642 153.34986236400005 M 1331.8329635387893 153.34986236400005 L 1331.8329635387893 166.92064664400004 L 1345.4037478187893 166.92064664400004" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="174.45997124400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="189.53862044400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• runs as a service with its own URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="204.61726964400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• client generates its own public and private key pair to sign assertions and authenticate to RPs</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="219.69591884400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• public keys are published at the clients well-known URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="234.77456804400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• client_id is the client URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="249.85321724400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a JWT client authentication to authenticate to IdPs and RPs</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="264.9318664440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a Relying Party in respect of the IdP in order to obtain an access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="280.01051564400007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as an identity forwarder that forwards identity claims tokens from the IdP to the RP</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1158.7765925576175 316.1992737240001 L 1845.6093756469925 316.1992737240001 L 1859.1801599269925 329.7700580040001 L 1859.1801599269925 365.9588160840001 L 1158.7765925576175 365.9588160840001 L 1158.7765925576175 316.1992737240001 M 1845.6093756469925 316.1992737240001 L 1845.6093756469925 329.7700580040001 L 1859.1801599269925 329.7700580040001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1179.8867014376174" y="337.3093826040001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1179.8867014376174" y="352.3880318040001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is a resource server using the local ABAC engine to automate authorization assessment</text></g><g><g><rect fill="white" stroke="none" x="981.2283819634767" y="388.5767898840001" width="482.29025735765623" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="403.65543908400014" width="202.99025430589845" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="418.7340882840001" width="509.02359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="433.8127374840001" width="408.20691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="448.89138668400005" width="160.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="463.970035884" width="294.25693216234373" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="402.14757416400016" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Client generates the resource_claims_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="417.22622336400013" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="432.3048725640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the URI that identifies who issues the resource_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="447.3835217640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud is the URI that identifies the requested resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="462.46217096400005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="477.540820164" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    exp, nbf are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 963.3853137434767 483.5722798440001 L 1023.6999105434767 483.5722798440001 L 1023.6999105434767 503.1745238040001 L 975.8000682514767 503.1745238040001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(963.3853137434767,503.1745238040001) translate(-963.3853137434767,-503.1745238040001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 975.9508547434767 496.8917533040001 L 963.3853137434767 503.1745238040001 L 975.9508547434767 509.45729430400013 Z"/></g></g><g><g><rect fill="white" stroke="none" x="284.60974035527346" y="525.7924976040001" width="462.7402695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="540.8711468040001" width="255.84026040941407" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="555.9497960040001" width="487.95691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="571.028445204" width="385.85693826585936" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="586.107094404" width="542.9902695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="601.185743604" width="306.70691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="616.264392804" width="456.29025735765623" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="631.3430420039999" width="432.50693216234373" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="646.4216912039999" width="193.12360086351563" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="661.5003404039999" width="153.4402665129297" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="676.5789896039998" width="288.39026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="691.6576388039998" width="160.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="706.7362880039998" width="284.39026346117186" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="539.3632818840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Request an identity_claims_token (token exchange request)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="554.4419310840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {grant_type = token-exchange,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="569.5205802840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     requested_token_type = urn:ietf:params:oauth:token-type:jwt,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="584.599229484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     subject_token = access_token_with_user_claims,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="599.677878684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     subject_token_type = urn:ietf:params:oauth:token-type:access_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="614.756527884" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     actor_token = resource_claims_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="629.835177084" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     actor_token_type = urn:ietf:params:oauth:token-type:jwt}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="644.9138262839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    and generate the authentication JWT with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="659.9924754839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, sub, aud, jti, exp}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="675.0711246839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="690.1497738839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud is the URI that identifies the IdP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="705.2284230839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="720.3070722839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    jti, exp are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 963.3853137434767 726.3385319640001 L 161.23919103975783 726.3385319640001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(148.82443653175784,726.3385319640001) translate(-148.82443653175784,-726.3385319640001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 161.38997753175784 720.0557614640002 L 148.82443653175784 726.3385319640001 L 161.38997753175784 732.6213024640001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="166.66750475175783" y="748.9565057640002" width="213.14026346117188" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="764.0351549640002" width="635.5569199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="779.1138041640002" width="579.6569565764063" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="794.1924533640001" width="611.0569199553125" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="762.5272900440002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Authorization assessment</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="777.6059392440002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the authentication token signature and evaluate the authentication claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="792.6845884440002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. verify the subject_token signature and evaluate the subject_token claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="807.7632376440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. verify the resource_claims_token signature and evaluate the resource claims </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 813.7946973240001 L 209.13903333175784 813.7946973240001 L 209.13903333175784 833.3969412840001 L 161.23919103975783 833.3969412840001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(148.82443653175784,833.3969412840001) translate(-148.82443653175784,-833.3969412840001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 161.38997753175784 827.1141707840002 L 148.82443653175784 833.3969412840001 L 161.38997753175784 839.6797117840001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="166.66750475175783" y="856.0149150840001" width="459.89026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="871.0935642840001" width="280.0569199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="886.172213484" width="501.52359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="901.250862684" width="784.9902695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="916.329511884" width="791.4402817717188" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="931.408161084" width="294.25693216234373" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="946.486810284" width="525.4236191740625" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="869.5856993640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. STS generates the identity_claims_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="884.6643485640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, act{sub}}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="899.742997764" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the URI that identifies who issues the identity_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="914.821646964" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud identifies the target service and it is the aud claim value extracted from the resource_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="929.900296164" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub identifies the principal by email address and was extracted from the access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="944.978945364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="960.0575945639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    act{sub} is the sub value extracted from the resource_claims_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 966.0890542440001 L 209.13903333175784 966.0890542440001 L 209.13903333175784 985.6912982040001 L 161.23919103975783 985.6912982040001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(148.82443653175784,985.6912982040001) translate(-148.82443653175784,-985.6912982040001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 161.38997753175784 979.4085277040001 L 148.82443653175784 985.6912982040001 L 161.38997753175784 991.974068704 Z"/></g></g><g><g><rect fill="white" stroke="none" x="305.98474035527346" y="1008.309272004" width="500.2402695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="305.98474035527346" y="1023.387921204" width="451.50693216234373" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="308.2465377352735" y="1021.880056284" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Return the identity_claims_token in the access_token parameter,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="308.2465377352735" y="1036.9587054840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    issued_token_type = urn:ietf:params:oauth:token-type:jwt</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 1042.990165164 L 950.9705592354767 1042.990165164" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(963.3853137434767,1042.990165164) translate(-963.3853137434767,-1042.990165164)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 950.8197727434766 1036.707394664 L 963.3853137434767 1042.990165164 L 950.8197727434766 1049.272935664 Z"/></g></g><g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1065.608138964" width="509.9069260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1080.686788164" width="432.50693216234373" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1095.765437364" width="193.12360086351563" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1110.844086564" width="153.4402665129297" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1125.922735764" width="408.20691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1141.001384964" width="160.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1156.080034164" width="284.39026346117186" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1079.178923244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Send HTTP request to resource_uri with the identity_claims_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1094.257572444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    and generate the authentication JWT with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1109.336221644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, sub, aud, jti, exp}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1124.414870844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1139.493520044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud is the URI that identifies the requested resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1154.572169244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1169.650818444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    jti, exp are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 963.3853137434767 1175.682278124 L 1496.563621734305 1175.682278124" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1508.9783762423049,1175.682278124) translate(-1508.9783762423049,-1175.682278124)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1496.412835242305 1169.399507624 L 1508.9783762423049 1175.682278124 L 1496.412835242305 1181.965048624 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1526.821444462305" y="1198.3002519240001" width="213.14026346117188" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1526.821444462305" y="1213.378901124" width="635.5569199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1526.821444462305" y="1228.457550324" width="591.3902329435938" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1529.083241842305" y="1211.8710362040001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Authorization assessment</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1529.083241842305" y="1226.949685404" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the authentication token signature and evaluate the authentication claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1529.083241842305" y="1242.028334604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. verify the identity_claims_token signature and evaluate the identity claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1508.9783762423049 1248.0597942840002 L 1569.2929730423048 1248.0597942840002 L 1569.2929730423048 1267.662038244 L 1521.3931307503049 1267.662038244" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1508.9783762423049,1267.662038244) translate(-1508.9783762423049,-1267.662038244)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1521.5439172423048 1261.3792677440001 L 1508.9783762423049 1267.662038244 L 1521.5439172423048 1273.944808744 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1010.120044561133" y="1290.2800120440002" width="452.1236008635156" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1012.381841941133" y="1303.8507963240002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Return HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1508.9783762423049 1309.882256004 L 975.8000682514767 1309.882256004" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(963.3853137434767,1309.882256004) translate(-963.3853137434767,-1309.882256004)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 975.9508547434767 1303.599485504 L 963.3853137434767 1309.882256004 L 975.9508547434767 1316.165026504 Z"/></g></g></g></g></svg>