<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="2126" height="1569"><desc>participant%20%22IdP%20%2B%20STS%22%20as%20IdP-STS%0Aparticipant%20%22Client%22%20as%20Client%0Aparticipant%20%22RP%22%20as%20RP%0A%0Abottomparticipants%0A%0Anote%20over%20IdP-STS%3AIdP%20%2B%20STS%3A%5Cn%E2%80%A2%20both%20act%20as%20the%20same%20authority%0Anote%20over%20Client%3AClient%3A%5Cn%E2%80%A2%20runs%20as%20a%20service%20with%20its%20own%20URI%5Cn%E2%80%A2%20client%20generates%20its%20own%20public%20and%20private%20key%20pair%20to%20sign%20assertions%20and%20authenticate%20to%20IdPs%20and%20RPs%5Cn%E2%80%A2%20public%20keys%20are%20published%20at%20the%20client's%20well-known%20URI%5Cn%E2%80%A2%20client_id%20is%20the%20client%20URI%5Cn%E2%80%A2%20uses%20a%20private_key_jwt%20client%20authentication%20method%20to%20authenticate%20to%20IdPs%20and%20RPs%5Cn%E2%80%A2%20acts%20as%20a%20Relying%20Party%20in%20respect%20of%20the%20IdP%20in%20order%20to%20obtain%20an%20access_token_with_user_claims%5Cn%E2%80%A2%20acts%20as%20an%20Identity%20Propagator%20of%20identity%20information%20provided%20by%20IdPs%20in%20respect%20of%20RPs%0Anote%20over%20RP%3ARP%3A%5Cn%E2%80%A2%20is%20a%20resource%20server%20using%20the%20local%20ABAC%20engine%20to%20automate%20authorization%20assessment%0AClient-%3EClient%3A1.%20Client%20generates%20the%20actor_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%7D%5Cn%20%20%20%20iss%20is%20the%20client_id%5Cn%20%20%20%20aud%20is%20the%20URI%20that%20identifies%20the%20RP%5Cn%20%20%20%20sub%20is%20the%20client_id%5Cn%20%20%20%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%0AClient-%3EClient%3A2.%20Client%20generates%20the%20authentication_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20sub%2C%20aud%2C%20jti%2C%20exp%7D%5Cn%20%20%20%20iss%20is%20the%20client_id%5Cn%20%20%20%20aud%20is%20the%20URI%20that%20identifies%20the%20IdP%5Cn%20%20%20%20sub%20is%20the%20client_id%5Cn%20%20%20%20jti%2C%20exp%20are%20the%20standard%20JWT%20claims%0AIdP-STS%3C-Client%3A3.%20Send%20an%20HTTP%20request%20to%20get%20an%20identity_token%20with%20the%20actor_token%20in%20the%20header%5Cn%20%20%20%20using%20the%20private_key_jwt%20client%20authentication%20method%5Cn%20%20%20%20%7Bgrant_type%20%3D%20token-exchange%2C%5Cn%20%20%20%20%20requested_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%2C%5Cn%20%20%20%20%20subject_token%20%3D%20access_token_with_user_claims%2C%5Cn%20%20%20%20%20subject_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token%2C%5Cn%20%20%20%20%20actor_token%20%3D%20actor_token%2C%5Cn%20%20%20%20%20actor_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%7D%0AIdP-STS-%3EIdP-STS%3A4.%20Authorization%20assessment%5Cn%20%20%20%201.%20verify%20the%20authentication_token%20signature%20using%20the%20client's%20public%20keys%5Cn%20%20%20%20%20%20%20%20published%20at%20the%20client's%20well%20known%20URI%2C%20and%20evaluate%20claims%5Cn%20%20%20%202.%20verify%20the%20actor_token%20signature%20using%20the%20client's%20public%20keys%5Cn%20%20%20%20%20%20%20%20published%20at%20the%20client's%20well%20known%20URI%2C%20and%20evaluate%20claims%5Cn%20%20%20%203.%20verify%20the%20access_token_with_user_claims%20signature%20and%20evaluate%20claims%20%0A%0AIdP-STS-%3EIdP-STS%3A5.%20STS%20generates%20the%20identity_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20act%7Bsub%7D%7D%5Cn%20%20%20%20iss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20identity_token%5Cn%20%20%20%20aud%20identifies%20the%20target%20service%20and%20it%20is%20the%20aud%20claim%20value%20extracted%20from%20the%20actor_token%5Cn%20%20%20%20sub%20identifies%20the%20principal%20by%20an%20email%20address%20that%20is%20extracted%20from%20the%20access_token_with_user_claims%5Cn%20%20%20%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20act%7Bsub%7D%20is%20the%20sub%20value%20extracted%20from%20the%20actor_token%0AClient%3C-IdP-STS%3A6.%20Return%20the%20identity_token%0A%0AClient-%3EClient%3A7.%20Client%20generates%20the%20authentication_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20sub%2C%20aud%2C%20jti%2C%20exp%7D%5Cn%20%20%20%20iss%20is%20the%20client_id%5Cn%20%20%20%20aud%20is%20the%20URI%20that%20identifies%20the%20RP%5Cn%20%20%20%20sub%20is%20the%20client_id%5Cn%20%20%20%20jti%2C%20exp%20are%20the%20standard%20JWT%20claims%0AClient-%3ERP%3A8.%20Send%20an%20HTTP%20request%20to%20the%20RP%20with%20the%20identity_token%20in%20the%20header%5Cn%20%20%20%20using%20the%20private_key_jwt%20client%20authentication%20method%0Aiss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20authentication_token%0ARP-%3ERP%3A9.%20Authorization%20assessment%5Cn%20%20%20%201.%20verify%20the%20authentication_token%20signature%20using%20the%20client's%20public%20keys%5Cn%20%20%20%20%20%20%20%20published%20at%20the%20client's%20well%20known%20URI%2C%20and%20evaluate%20claims%5Cn%20%20%20%202.%20verify%20the%20identity_token%20signature%20and%20evaluate%20claims%0ARP-%3EClient%3A10.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="2126" height="1569"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 50.815047804 L 148.82443653175784 1516.459750044" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 971.6186511458204 50.815047804 L 971.6186511458204 1516.459750044" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1541.7117441622268 50.815047804 L 1541.7117441622268 1516.459750044" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 96.59743726328324 10.253481456000003 L 201.05143580023247 10.253481456000003 L 201.05143580023247 50.815047804 L 96.59743726328324 50.815047804 L 96.59743726328324 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.95777164528323" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 934.0083167638204 10.253481456000003 L 1009.2289855278204 10.253481456000003 L 1009.2289855278204 50.815047804 L 934.0083167638204 50.815047804 L 934.0083167638204 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="950.3686511458204" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1515.8264101616965 10.253481456000003 L 1567.597078162757 10.253481456000003 L 1567.597078162757 50.815047804 L 1515.8264101616965 50.815047804 L 1515.8264101616965 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1532.1867445436965" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 96.59743726328324 1516.459750044 L 201.05143580023247 1516.459750044 L 201.05143580023247 1557.021316392 L 96.59743726328324 1557.021316392 L 96.59743726328324 1516.459750044 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.95777164528323" y="1541.942667192" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 934.0083167638204 1516.459750044 L 1009.2289855278204 1516.459750044 L 1009.2289855278204 1557.021316392 L 934.0083167638204 1557.021316392 L 934.0083167638204 1516.459750044 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="950.3686511458204" y="1541.942667192" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1515.8264101616965 1516.459750044 L 1567.597078162757 1516.459750044 L 1567.597078162757 1557.021316392 L 1515.8264101616965 1557.021316392 L 1515.8264101616965 1516.459750044 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1532.1867445436965" y="1541.942667192" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 80.97234620399999 L 276.5387641835157 80.97234620399999 L 290.1095484635157 94.54313048399999 L 290.1095484635157 130.731888564 L 7.5393246000000005 130.731888564 L 7.5393246000000005 80.97234620399999 M 276.5387641835157 80.97234620399999 L 276.5387641835157 94.54313048399999 L 290.1095484635157 94.54313048399999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.649433480000027" y="102.08245508399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.649433480000027" y="117.16110428399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• both act as the same authority</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 564.3085300587892 153.34986236400005 L 1365.3579879528518 153.34986236400005 L 1378.9287722328518 166.92064664400004 L 1378.9287722328518 293.58129992400006 L 564.3085300587892 293.58129992400006 L 564.3085300587892 153.34986236400005 M 1365.3579879528518 153.34986236400005 L 1365.3579879528518 166.92064664400004 L 1378.9287722328518 166.92064664400004" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="585.4186389387892" y="174.45997124400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="585.4186389387892" y="189.53862044400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• runs as a service with its own URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="585.4186389387892" y="204.61726964400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• client generates its own public and private key pair to sign assertions and authenticate to IdPs and RPs</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="585.4186389387892" y="219.69591884400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• public keys are published at the client's well-known URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="585.4186389387892" y="234.77456804400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• client_id is the client URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="585.4186389387892" y="249.85321724400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a private_key_jwt client authentication method to authenticate to IdPs and RPs</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="585.4186389387892" y="264.9318664440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a Relying Party in respect of the IdP in order to obtain an access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="585.4186389387892" y="280.01051564400007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as an Identity Propagator of identity information provided by IdPs in respect of RPs</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1191.5099604775394 316.1992737240001 L 1878.3427435669144 316.1992737240001 L 1891.9135278469143 329.7700580040001 L 1891.9135278469143 365.9588160840001 L 1191.5099604775394 365.9588160840001 L 1191.5099604775394 316.1992737240001 M 1878.3427435669144 316.1992737240001 L 1878.3427435669144 329.7700580040001 L 1891.9135278469143 329.7700580040001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1212.6200693575393" y="337.3093826040001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1212.6200693575393" y="352.3880318040001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is a resource server using the local ABAC engine to automate authorization assessment</text></g><g><g><rect fill="white" stroke="none" x="989.4617193658205" y="388.5767898840001" width="402.10693826585936" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="403.65543908400014" width="202.99025430589845" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="418.7340882840001" width="153.4402665129297" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="433.8127374840001" width="284.9402512541406" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="448.89138668400005" width="160.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="463.970035884" width="294.25693216234373" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="402.14757416400016" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Client generates the actor_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="417.22622336400013" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="432.3048725640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="447.3835217640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud is the URI that identifies the RP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="462.46217096400005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="477.540820164" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    exp, nbf are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 971.6186511458204 483.5722798440001 L 1031.9332479458203 483.5722798440001 L 1031.9332479458203 503.1745238040001 L 984.0334056538204 503.1745238040001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(971.6186511458204,503.1745238040001) translate(-971.6186511458204,-503.1745238040001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 984.1841921458205 496.8917533040001 L 971.6186511458204 503.1745238040001 L 984.1841921458205 509.45729430400013 Z"/></g></g><g><g><rect fill="white" stroke="none" x="989.4617193658205" y="525.7924976040001" width="470.95691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="540.8711468040001" width="193.12360086351563" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="555.9497960040001" width="153.4402665129297" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="571.028445204" width="288.39026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="586.107094404" width="160.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="601.185743604" width="284.39026346117186" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="539.3632818840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Client generates the authentication_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="554.4419310840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, sub, aud, jti, exp}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="569.5205802840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="584.599229484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud is the URI that identifies the IdP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="599.677878684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="614.756527884" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    jti, exp are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 971.6186511458204 620.7879875640001 L 1031.9332479458203 620.7879875640001 L 1031.9332479458203 640.3902315240001 L 984.0334056538204 640.3902315240001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(971.6186511458204,640.3902315240001) translate(-971.6186511458204,-640.3902315240001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 984.1841921458205 634.1074610240001 L 971.6186511458204 640.3902315240001 L 984.1841921458205 646.6730020240001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="247.96807775761724" y="663.0082053240001" width="624.5069321623438" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="678.086854524" width="427.9902695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="693.165503724" width="255.84026040941407" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="708.244152924" width="487.95691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="723.322802124" width="385.85693826585936" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="738.4014513239999" width="542.9902695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="753.4801005239999" width="226.52359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="768.5587497239999" width="456.29025735765623" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="676.5789896040001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Send an HTTP request to get an identity_token with the actor_token in the header</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="691.657638804" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    using the private_key_jwt client authentication method</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="706.736288004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {grant_type = token-exchange,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="721.814937204" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     requested_token_type = urn:ietf:params:oauth:token-type:jwt,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="736.893586404" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     subject_token = access_token_with_user_claims,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="751.9722356039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     subject_token_type = urn:ietf:params:oauth:token-type:access_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="767.0508848039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     actor_token = actor_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="782.1295340039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     actor_token_type = urn:ietf:params:oauth:token-type:jwt}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 971.6186511458204 788.1609936840001 L 161.23919103975783 788.1609936840001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(148.82443653175784,788.1609936840001) translate(-148.82443653175784,-788.1609936840001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 161.38997753175784 781.8782231840001 L 148.82443653175784 788.1609936840001 L 161.38997753175784 794.4437641840001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="166.66750475175783" y="810.7789674840002" width="213.14026346117188" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="825.8576166840002" width="562.090245150625" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="840.9362658840001" width="491.9069260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="856.0149150840001" width="493.2402695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="871.0935642840001" width="491.9069260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="886.172213484" width="577.9069565764063" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="824.3497517640002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Authorization assessment</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="839.4284009640002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the authentication_token signature using the client's public keys</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="854.5070501640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        published at the client's well known URI, and evaluate claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="869.5856993640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. verify the actor_token signature using the client's public keys</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="884.6643485640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        published at the client's well known URI, and evaluate claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="899.742997764" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. verify the access_token_with_user_claims signature and evaluate claims </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 905.7744574440002 L 209.13903333175784 905.7744574440002 L 209.13903333175784 925.3767014040002 L 161.23919103975783 925.3767014040002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(148.82443653175784,925.3767014040002) translate(-148.82443653175784,-925.3767014040002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 161.38997753175784 919.0939309040002 L 148.82443653175784 925.3767014040002 L 161.38997753175784 931.6594719040002 Z"/></g></g><g><g><rect fill="white" stroke="none" x="166.66750475175783" y="947.9946752040001" width="405.39026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="963.0733244040001" width="280.0569199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="978.1519736040001" width="447.02359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="993.2306228040001" width="704.8069199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="1008.309272004" width="799.6736191740625" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="1023.387921204" width="294.25693216234373" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="1038.466570404" width="445.2402695646875" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="961.5654594840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. STS generates the identity_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="976.6441086840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, act{sub}}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="991.7227578840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the URI that identifies who issues the identity_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="1006.8014070840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud identifies the target service and it is the aud claim value extracted from the actor_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="1021.880056284" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub identifies the principal by an email address that is extracted from the access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="1036.9587054840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="1052.037354684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    act{sub} is the sub value extracted from the actor_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 1058.0688143640002 L 209.13903333175784 1058.0688143640002 L 209.13903333175784 1077.6710583240001 L 161.23919103975783 1077.6710583240001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(148.82443653175784,1077.6710583240001) translate(-148.82443653175784,-1077.6710583240001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 161.38997753175784 1071.3882878240001 L 148.82443653175784 1077.6710583240001 L 161.38997753175784 1083.953828824 Z"/></g></g><g><g><rect fill="white" stroke="none" x="455.393080809375" y="1100.2890321240002" width="209.65692605882813" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="457.65487818937504" y="1113.8598164040002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Return the identity_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 1119.891276084 L 959.2038966378204 1119.891276084" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(971.6186511458204,1119.891276084) translate(-971.6186511458204,-1119.891276084)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 959.0531101458204 1113.608505584 L 971.6186511458204 1119.891276084 L 959.0531101458204 1126.174046584 Z"/></g></g><g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1142.509249884" width="470.95691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1157.587899084" width="193.12360086351563" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1172.6665482839999" width="153.4402665129297" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1187.7451974839998" width="284.9402512541406" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1202.8238466839998" width="160.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1217.9024958839998" width="284.39026346117186" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1156.080034164" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Client generates the authentication_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1171.158683364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, sub, aud, jti, exp}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1186.2373325639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1201.3159817639998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud is the URI that identifies the RP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1216.3946309639998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1231.4732801639998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    jti, exp are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 971.6186511458204 1237.5047398440001 L 1031.9332479458203 1237.5047398440001 L 1031.9332479458203 1257.106983804 L 984.0334056538204 1257.106983804" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(971.6186511458204,1257.106983804) translate(-971.6186511458204,-1257.106983804)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 984.1841921458205 1250.824213304 L 971.6186511458204 1257.106983804 L 984.1841921458205 1263.389754304 Z"/></g></g><g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1279.7249576039999" width="534.4069565764063" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1294.8036068039999" width="427.9902695646875" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1293.2957418839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Send an HTTP request to the RP with the identity_token in the header</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1308.3743910839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    using the private_key_jwt client authentication method</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 971.6186511458204 1314.405850764 L 1529.2969896542268 1314.405850764" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1541.7117441622268,1314.405850764) translate(-1541.7117441622268,-1314.405850764)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1529.1462031622268 1308.123080264 L 1541.7117441622268 1314.405850764 L 1529.1462031622268 1320.688621264 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1559.5548123822268" y="1337.023824564" width="213.14026346117188" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1559.5548123822268" y="1352.102473764" width="562.090245150625" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1559.5548123822268" y="1367.181122964" width="491.9069260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1559.5548123822268" y="1382.259772164" width="447.47360696703123" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1561.8166097622268" y="1350.594608844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. Authorization assessment</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1561.8166097622268" y="1365.673258044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the authentication_token signature using the client's public keys</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1561.8166097622268" y="1380.751907244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        published at the client's well known URI, and evaluate claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1561.8166097622268" y="1395.830556444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. verify the identity_token signature and evaluate claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1541.7117441622268 1401.862016124 L 1602.0263409622266 1401.862016124 L 1602.0263409622266 1421.464260084 L 1554.1264986702267 1421.464260084" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1541.7117441622268,1421.464260084) translate(-1541.7117441622268,-1421.464260084)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1554.2772851622267 1415.181489584 L 1541.7117441622268 1421.464260084 L 1554.2772851622267 1427.747030584 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1011.5617407281252" y="1444.082233884" width="490.20691385179686" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1013.8235381081251" y="1457.653018164" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1541.7117441622268 1463.684477844 L 984.0334056538204 1463.684477844" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(971.6186511458204,1463.684477844) translate(-971.6186511458204,-1463.684477844)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 984.1841921458205 1457.401707344 L 971.6186511458204 1463.684477844 L 984.1841921458205 1469.967248344 Z"/></g></g></g></g></svg>