<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1881" height="1355"><desc>participant%20%22IdP%20%2B%20STS%22%20as%20IdP-STS%0Aparticipant%20%22Client%22%20as%20Client%0Aparticipant%20%22RP%22%20as%20RP%0A%0Abottomparticipants%0A%0Anote%20over%20IdP-STS%3AIdP%20%2B%20STS%3A%5Cn%E2%80%A2%20both%20act%20as%20the%20same%20authority%0Anote%20over%20Client%3AClient%3A%5Cn%E2%80%A2%20runs%20as%20a%20service%20with%20its%20own%20URI%5Cn%E2%80%A2%20client%20generates%20its%20own%20public%20and%20private%20key%20pair%20to%20sign%20assertions%20and%20authenticate%20to%20RPs%5Cn%E2%80%A2%20public%20keys%20are%20published%20at%20the%20clients%20well-known%20URI%5Cn%E2%80%A2%20client_id%20is%20the%20client%20URI%5Cn%E2%80%A2%20uses%20a%20JWT%20client%20authentication%20to%20authenticate%20to%20RPs%5Cn%E2%80%A2%20is%20registered%20at%20IdP%20as%20a%20confidential%20client%5Cn%E2%80%A2%20acts%20as%20a%20Relying%20Party%20in%20respect%20of%20the%20IdP%20in%20order%20to%20obtain%20an%20access_token_with_user_claims%5Cn%E2%80%A2%20acts%20as%20a%20token%20forwarder%20that%20forwards%20tokens%20from%20the%20STS%20to%20the%20RP%0Anote%20over%20RP%3ARP%3A%5Cn%E2%80%A2%20is%20a%20resource%20server%20using%20the%20local%20ABAC%20engine%20to%20automate%20authorization%20assessment%0AClient-%3EClient%3A1.%20Client%20generates%20the%20resource_claims_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%7D%5Cn%20%20%20%20iss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20resource_claims_token%5Cn%20%20%20%20aud%20is%20the%20URI%20that%20identifies%20the%20requested%20resource%5Cn%20%20%20%20sub%20is%20the%20client_id%5Cn%20%20%20%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%0AIdP-STS%3C-Client%3A2.%20Request%20an%20identity_claims_token%20(token%20exchange%20request)%5Cn%20%20%20%20%7Bgrant_type%20%3D%20token-exchange%2C%5Cn%20%20%20%20%20requested_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%2C%5Cn%20%20%20%20%20subject_token%20%3D%20access_token_with_user_claims%2C%5Cn%20%20%20%20%20subject_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token%2C%5Cn%20%20%20%20%20actor_token%20%3D%20resource_claims_token%2C%5Cn%20%20%20%20%20actor_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%7D%0AIdP-STS-%3EIdP-STS%3A3.%20Authorization%20assessment%5Cn%20%20%20%201.%20verify%20the%20subject_token%20signature%5Cn%20%20%20%202.%20evaluate%20the%20subject_token%20claims%5Cn%20%20%20%203.%20verify%20the%20resource_claims_token%20signature%5Cn%20%20%20%204.%20evaluate%20the%20resource%20claims%20%0A%0AIdP-STS-%3EIdP-STS%3A4.%20STS%20generates%20the%20identity_claims_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20act%7Bsub%7D%7D%5Cn%20%20%20%20iss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20identity_claims_token%5Cn%20%20%20%20aud%20identifies%20the%20target%20service%20and%20it%20is%20the%20aud%20claim%20value%20extracted%20from%20the%20resource_claims_token%5Cn%20%20%20%20sub%20identifies%20the%20principal%20by%20email%20address%20and%20was%20extracted%20from%20the%20access_token_with_user_claims%5Cn%20%20%20%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20act%7Bsub%7D%20is%20the%20sub%20value%20extracted%20from%20the%20resource_claims_token%0AClient%3C-IdP-STS%3A5.%20Return%20the%20identity_claims_token%20in%20the%20access_token%20parameter%2C%5Cn%20%20%20%20issued_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%0A%0AClient-%3ERP%3A6.%20Send%20HTTP%20request%20to%20resource_uri%20with%20the%20identity_claims_token%2C%5Cn%20%20%20%20and%20generates%20the%20authentication%20JWT%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20sub%2C%20aud%2C%20jti%2C%20exp%7D%5Cn%20%20%20%20iss%20is%20the%20client_id%5Cn%20%20%20%20aud%20is%20the%20URI%20that%20identifies%20the%20requested%20resource%5Cn%20%20%20%20sub%20is%20the%20client_id%5Cn%20%20%20%20jti%2C%20exp%20are%20the%20standard%20JWT%20claims%0Aiss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20authentication%20token%0ARP-%3ERP%3A7.%20Authorization%20assessment%5Cn%20%20%20%201.%20verify%20the%20identity_claims_token%20signature%5Cn%20%20%20%202.%20evaluate%20the%20identity%20claims%0ARP-%3EClient%3A8.%20Return%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1881" height="1355"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 50.815047804 L 148.82443653175784 1302.342931404" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 963.3853137434767 50.815047804 L 963.3853137434767 1302.342931404" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1508.9783762423049 50.815047804 L 1508.9783762423049 1302.342931404" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 96.59743726328324 10.253481456000003 L 201.05143580023247 10.253481456000003 L 201.05143580023247 50.815047804 L 96.59743726328324 50.815047804 L 96.59743726328324 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.95777164528323" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 925.7749793614767 10.253481456000003 L 1000.9956481254767 10.253481456000003 L 1000.9956481254767 50.815047804 L 925.7749793614767 50.815047804 L 925.7749793614767 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="942.1353137434767" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1483.0930422417746 10.253481456000003 L 1534.8637102428352 10.253481456000003 L 1534.8637102428352 50.815047804 L 1483.0930422417746 50.815047804 L 1483.0930422417746 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1499.4533766237746" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 96.59743726328324 1302.342931404 L 201.05143580023247 1302.342931404 L 201.05143580023247 1342.904497752 L 96.59743726328324 1342.904497752 L 96.59743726328324 1302.342931404 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.95777164528323" y="1327.825848552" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 925.7749793614767 1302.342931404 L 1000.9956481254767 1302.342931404 L 1000.9956481254767 1342.904497752 L 925.7749793614767 1342.904497752 L 925.7749793614767 1302.342931404 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="942.1353137434767" y="1327.825848552" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1483.0930422417746 1302.342931404 L 1534.8637102428352 1302.342931404 L 1534.8637102428352 1342.904497752 L 1483.0930422417746 1342.904497752 L 1483.0930422417746 1302.342931404 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1499.4533766237746" y="1327.825848552" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 80.97234620399999 L 276.5387641835157 80.97234620399999 L 290.1095484635157 94.54313048399999 L 290.1095484635157 130.731888564 L 7.5393246000000005 130.731888564 L 7.5393246000000005 80.97234620399999 M 276.5387641835157 80.97234620399999 L 276.5387641835157 94.54313048399999 L 290.1095484635157 94.54313048399999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.649433480000027" y="102.08245508399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.649433480000027" y="117.16110428399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• both act as the same authority</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 581.3668796681642 153.34986236400002 L 1331.8329635387893 153.34986236400002 L 1345.4037478187893 166.92064664400002 L 1345.4037478187893 308.65994912400004 L 581.3668796681642 308.65994912400004 L 581.3668796681642 153.34986236400002 M 1331.8329635387893 153.34986236400002 L 1331.8329635387893 166.92064664400002 L 1345.4037478187893 166.92064664400002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="174.45997124400003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="189.53862044400003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• runs as a service with its own URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="204.61726964400003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• client generates its own public and private key pair to sign assertions and authenticate to RPs</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="219.69591884400003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• public keys are published at the clients well-known URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="234.77456804400003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• client_id is the client URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="249.85321724400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a JWT client authentication to authenticate to RPs</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="264.93186644400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at IdP as a confidential client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="280.01051564400007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a Relying Party in respect of the IdP in order to obtain an access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.4769885481642" y="295.08916484400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a token forwarder that forwards tokens from the STS to the RP</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1158.7765925576175 331.27792292400005 L 1845.6093756469925 331.27792292400005 L 1859.1801599269925 344.84870720400005 L 1859.1801599269925 381.03746528400006 L 1158.7765925576175 381.03746528400006 L 1158.7765925576175 331.27792292400005 M 1845.6093756469925 331.27792292400005 L 1845.6093756469925 344.84870720400005 L 1859.1801599269925 344.84870720400005" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1179.8867014376174" y="352.3880318040001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1179.8867014376174" y="367.46668100400007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is a resource server using the local ABAC engine to automate authorization assessment</text></g><g><g><rect fill="white" stroke="none" x="981.2283819634767" y="403.655439084" width="482.29025735765623" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="418.734088284" width="202.99025430589845" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="433.81273748399997" width="509.02359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="448.89138668399994" width="408.20691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="463.9700358839999" width="160.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="479.0486850839999" width="294.25693216234373" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="417.226223364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Client generates the resource_claims_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="432.304872564" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="447.38352176399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the URI that identifies who issues the resource_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="462.46217096399994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud is the URI that identifies the requested resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="477.5408201639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="492.6194693639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    exp, nbf are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 963.3853137434767 498.650929044 L 1023.6999105434767 498.650929044 L 1023.6999105434767 518.253173004 L 975.8000682514767 518.253173004" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(963.3853137434767,518.253173004) translate(-963.3853137434767,-518.253173004)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 975.9508547434767 511.970402504 L 963.3853137434767 518.253173004 L 975.9508547434767 524.535943504 Z"/></g></g><g><g><rect fill="white" stroke="none" x="284.60974035527346" y="540.8711468040001" width="462.7402695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="555.9497960040001" width="255.84026040941407" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="571.028445204" width="487.95691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="586.107094404" width="385.85693826585936" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="601.185743604" width="542.9902695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="616.264392804" width="306.70691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="284.60974035527346" y="631.3430420039999" width="456.29025735765623" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="554.4419310840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Request an identity_claims_token (token exchange request)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="569.5205802840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {grant_type = token-exchange,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="584.599229484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     requested_token_type = urn:ietf:params:oauth:token-type:jwt,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="599.677878684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     subject_token = access_token_with_user_claims,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="614.756527884" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     subject_token_type = urn:ietf:params:oauth:token-type:access_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="629.835177084" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     actor_token = resource_claims_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="286.8715377352735" y="644.9138262839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     actor_token_type = urn:ietf:params:oauth:token-type:jwt}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 963.3853137434767 650.945285964 L 161.23919103975783 650.945285964" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(148.82443653175784,650.945285964) translate(-148.82443653175784,-650.945285964)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 161.38997753175784 644.6625154640001 L 148.82443653175784 650.945285964 L 161.38997753175784 657.228056464 Z"/></g></g><g><g><rect fill="white" stroke="none" x="166.66750475175783" y="673.563259764" width="213.14026346117188" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="688.641908964" width="292.0569199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="703.720558164" width="292.52359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="718.7992073639999" width="356.85693826585936" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="733.8778565639999" width="259.1236008635156" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="687.134044044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Authorization assessment</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="702.212693244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the subject_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="717.291342444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. evaluate the subject_token claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="732.3699916439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. verify the resource_claims_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="747.4486408439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    4. evaluate the resource claims </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 753.480100524 L 209.13903333175784 753.480100524 L 209.13903333175784 773.082344484 L 161.23919103975783 773.082344484" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(148.82443653175784,773.082344484) translate(-148.82443653175784,-773.082344484)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 161.38997753175784 766.7995739840001 L 148.82443653175784 773.082344484 L 161.38997753175784 779.365114984 Z"/></g></g><g><g><rect fill="white" stroke="none" x="166.66750475175783" y="795.700318284" width="459.89026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="810.778967484" width="280.0569199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="825.8576166839999" width="501.52359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="840.9362658839999" width="784.9902695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="856.0149150839999" width="791.4402817717188" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="871.0935642839999" width="294.25693216234373" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="886.1722134839998" width="525.4236191740625" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="809.271102564" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. STS generates the identity_claims_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="824.349751764" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, act{sub}}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="839.4284009639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the URI that identifies who issues the identity_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="854.5070501639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud identifies the target service and it is the aud claim value extracted from the resource_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="869.5856993639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub identifies the principal by email address and was extracted from the access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="884.6643485639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="899.7429977639998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    act{sub} is the sub value extracted from the resource_claims_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 905.774457444 L 209.13903333175784 905.774457444 L 209.13903333175784 925.376701404 L 161.23919103975783 925.376701404" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(148.82443653175784,925.376701404) translate(-148.82443653175784,-925.376701404)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 161.38997753175784 919.093930904 L 148.82443653175784 925.376701404 L 161.38997753175784 931.6594719039999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="305.98474035527346" y="947.994675204" width="500.2402695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="305.98474035527346" y="963.073324404" width="451.50693216234373" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="308.2465377352735" y="961.565459484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Return the identity_claims_token in the access_token parameter,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="308.2465377352735" y="976.644108684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    issued_token_type = urn:ietf:params:oauth:token-type:jwt</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 982.675568364 L 950.9705592354767 982.675568364" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(963.3853137434767,982.675568364) translate(-963.3853137434767,-982.675568364)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 950.8197727434766 976.392797864 L 963.3853137434767 982.675568364 L 950.8197727434766 988.958338864 Z"/></g></g><g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1005.293542164" width="509.9069260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1020.372191364" width="440.1569260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1035.450840564" width="193.12360086351563" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1050.529489764" width="153.4402665129297" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1065.6081389639999" width="408.20691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1080.6867881639998" width="160.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="981.2283819634767" y="1095.7654373639998" width="284.39026346117186" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1018.864326444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Send HTTP request to resource_uri with the identity_claims_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1033.942975644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    and generates the authentication JWT with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1049.021624844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, sub, aud, jti, exp}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1064.100274044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1079.1789232439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud is the URI that identifies the requested resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1094.2575724439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4901793434767" y="1109.3362216439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    jti, exp are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 963.3853137434767 1115.367681324 L 1496.563621734305 1115.367681324" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1508.9783762423049,1115.367681324) translate(-1508.9783762423049,-1115.367681324)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1496.412835242305 1109.084910824 L 1508.9783762423049 1115.367681324 L 1496.412835242305 1121.650451824 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1526.821444462305" y="1137.985655124" width="213.14026346117188" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1526.821444462305" y="1153.064304324" width="349.35693826585936" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1526.821444462305" y="1168.142953524" width="246.95692911058595" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1529.083241842305" y="1151.556439404" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Authorization assessment</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1529.083241842305" y="1166.635088604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the identity_claims_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1529.083241842305" y="1181.713737804" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. evaluate the identity claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1508.9783762423049 1187.745197484 L 1569.2929730423048 1187.745197484 L 1569.2929730423048 1207.347441444 L 1521.3931307503049 1207.347441444" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1508.9783762423049,1207.347441444) translate(-1508.9783762423049,-1207.347441444)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1521.5439172423048 1201.064670944 L 1508.9783762423049 1207.347441444 L 1521.5439172423048 1213.630211944 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1010.120044561133" y="1229.965415244" width="452.1236008635156" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1012.381841941133" y="1243.536199524" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Return HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1508.9783762423049 1249.567659204 L 975.8000682514767 1249.567659204" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(963.3853137434767,1249.567659204) translate(-963.3853137434767,-1249.567659204)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 975.9508547434767 1243.284888704 L 963.3853137434767 1249.567659204 L 975.9508547434767 1255.850429704 Z"/></g></g></g></g></svg>