<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="2458" height="1835"><desc>participant%20%22AuthZ%20Server%20%E2%80%93%20Requesting%20Party%20(AS-RqP)%22%20as%20AS-RqP%0Aparticipant%20%22Client%22%20as%20Client%0Aparticipant%20%22Resource%20Server%20(RS)%22%20as%20RS%0Aparticipant%20%22AuthZ%20Server%20%E2%80%93%20Resource%20Owner%20(AS-RO)%22%20as%20AS-RO%0A%0Abottomparticipants%0A%0Anote%20over%20AS-RqP%3AAS-RqP%3A%5Cn%E2%80%A2%20supports%20the%20token%20exchange%20extension%20of%20OAuth2%20as%20an%20STS%20service%5Cn%E2%80%A2%20publishes%20its%20metadata%20on%20a%20URL%20%2F.well-known%2Foauth-authorization-server%5Cn%E2%80%A2%20also%20acts%20as%20RqP's%20Identity%20Provider%0Anote%20over%20Client%3AClient%3A%5Cn%E2%80%A2%20is%20registered%20at%20AS-RqP%20as%20a%20public%20or%20confidential%20client%5Cn%E2%80%A2%20acts%20as%20a%20Relying%20Party%20in%20respect%20of%20the%20RqP's%20Identity%20Provider%20in%20order%20to%20obtain%20an%20access_token_with_user_claims%5Cn%E2%80%A2%20is%20registered%20at%20AS-RO%20as%20a%20public%20or%20confidential%20client%5Cn%E2%80%A2%20acts%20as%20a%20token%20forwarder%20that%20forwards%20tokens%20between%20the%20RS%20and%20STS%2C%20and%20between%20the%20STS%20and%20AS-RO%0Anote%20over%20RS%3ARO%20has%20set%20up%20the%20RS%2C%20registers%20the%20resources%20at%20the%20AS-RO%20and%20sets%20policies%0ARS%3C-Client%3A1.%20Send%20HTTP%20request%20to%20the%20resource_uri%20with%20no%20access%20token%0ARS-%3EAS-RO%3A2.%20Request%20a%20permission_ticket%20and%20resource_claims_token%5Cn%7BPAT%7D%0Anote%20over%20AS-RO%3A%20AS-RO%20generates%20the%20permission_ticket%20(a%20JWT%20with%20a%20random%20NONCE%20value%20in%20the%20sub%20claim)%5Cnand%20the%20resource_claims_token%20which%20is%20bound%20to%20the%20permission_ticket%20through%20the%20permission_ticket%20sub%20claim%20hash.%5CnThe%20resource_claims_token%20contains%20these%20claims%3A%5Cn%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%7D%5Cniss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20resource_claims_token%5Cnaud%20is%20the%20URI%20that%20identifies%20the%20requested%20resource%5Cnsub%20is%20the%20permission_ticket%20sub%20claim%20hash%20computed%20as%20Base64URL-Encode(SHA256(permission_ticket%7Bsub%7D)%5Cnexp%2C%20nbf%20are%20the%20standard%20JWT%20claims)%0ARS%3C-AS-RO%3A3.%20Return%20the%20permission_ticket%2C%20resource_claims_token%2C%5Cn%20%20%20%20issued_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%0ARS-%3EClient%3A4.%20Return%20401%20with%20the%20permission_ticket%2C%20resource_claims_token%2C%5Cn%20%20%20%20issued_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%0AAS-RqP%3C-Client%3A5.%20Request%20an%20identity_claims_token%20(token%20exchange%20request)%5Cn%20%20%20%20%7Bgrant_type%20%3D%20token-exchange%2C%5Cn%20%20%20%20%20requested_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%2C%5Cn%20%20%20%20%20subject_token%20%3D%20access_token_with_user_claims%2C%5Cn%20%20%20%20%20subject_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token%2C%5Cn%20%20%20%20%20actor_token%20%3D%20resource_claims_token%2C%5Cn%20%20%20%20%20actor_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%7D%0Agroup%20Authorization%20assessment%20%E2%80%93%20evaluate%20the%20resource%20provenance%20%2F%20ownership%0Anote%20over%20AS-RqP%3A1.%20verify%20the%20subject_token%20signature%5Cn2.%20evaluate%20the%20subject_token%20claims%5Cn3.%20verify%20the%20resource_claims_token%20signature%5Cn4.%20evaluate%20the%20resource%20claims%20%0Aend%0Anote%20over%20AS-RqP%3AAS-RqP%20generates%20the%20identity_claims_token%20with%20these%20claims%3A%5Cn%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20act%7Bsub%7D%7D%5Cniss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20identity_claims_token%5Cnaud%20identifies%20the%20target%20service%20and%20it%20is%20the%20iss%20claim%20value%20extracted%20from%20the%20resource_claims_token%5Cnsub%20identifies%20the%20principal%20by%20email%20address%20and%20was%20extracted%20from%20the%20access_token_with_user_claims%5Cnexp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cnact%7Bsub%7D%20is%20the%20sub%20value%20extracted%20from%20the%20resource_claims_token%0AClient%3C-AS-RqP%3A6.%20Return%20the%20identity_claims_token%20in%20the%20access_token%20parameter%2C%5Cn%20%20%20%20issued_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%0A%0AClient-%3EAS-RO%3A7.%20Request%20a%20Requesting%20Party%20Token%20(RPT)%5Cn%20%20%20%20%7Bgrant_type%20%3D%20uma-ticket%2C%5Cn%20%20%20%20%20ticket%20%3D%20permission_ticket%2C%5Cn%20%20%20%20%20claim_token%20%3D%20identity_claims_token%2C%5Cn%20%20%20%20%20claim_token_format%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%7D%0Agroup%20Authorization%20assessment%20%E2%80%93%20evaluate%20the%20RqP%20identity%20provenance%20%2F%20ownership%0Anote%20over%20AS-RO%3A1.%20verify%20the%20permission%20ticket%20signature%5Cn2.%20evaluate%20the%20permission_ticket%20claims%5Cn3.%20verify%20the%20identity_claims_token%20signature%5Cn4.%20evaluate%20the%20identity%20claims%5Cn5.%20compare%20identity_claims_token%7Bact%7Bsub%7D%7D%20vs.%20Base64URL-Encode(SHA256(permission_ticket%7Bsub%7D))%0Aend%0Anote%20over%20AS-RO%3AAS-RO%20generates%20the%20RPT%20with%20these%20additional%20claims%3A%5Cn%7Bpermissions%7D%5Cnpermissions%2C%20all%20permissions%20granted%20by%20the%20authorization%20server%0AClient%3C-AS-RO%3A8.%20Return%20the%20RPT%2C%20optionally%20a%20refresh_token%0ARS%3C-Client%3A9.%20Send%20HTTP%20request%20to%20resource_uri%5Cn%20%20%20%20%7BRPT%7D%0ARS-%3EClient%3A10.%20Return%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="2458" height="1835"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 412.77443347999997 50.815047804 L 412.77443347999997 1781.8439759640003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 991.4508394846874 50.815047804 L 991.4508394846874 1781.8439759640003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1509.4105706846874 50.815047804 L 1509.4105706846874 1781.8439759640003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1996.603639287031 50.815047804 L 1996.603639287031 1781.8439759640003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 242.59743344858592 10.253481456000003 L 582.951433511414 10.253481456000003 L 582.951433511414 50.815047804 L 242.59743344858592 50.815047804 L 242.59743344858592 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="258.9577678305859" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthZ Server – Requesting Party (AS-RqP)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 953.8405051026874 10.253481456000003 L 1029.0611738666873 10.253481456000003 L 1029.0611738666873 50.815047804 L 953.8405051026874 50.815047804 L 953.8405051026874 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="970.2008394846874" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1415.1835676015155 10.253481456000003 L 1603.6375737678593 10.253481456000003 L 1603.6375737678593 50.815047804 L 1415.1835676015155 50.815047804 L 1415.1835676015155 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1431.5439019835155" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1832.0933110085466 10.253481456000003 L 2161.1139675655154 10.253481456000003 L 2161.1139675655154 50.815047804 L 1832.0933110085466 50.815047804 L 1832.0933110085466 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1848.4536453905466" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthZ Server – Resource Owner (AS-RO)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 242.59743344858592 1781.8439759640003 L 582.951433511414 1781.8439759640003 L 582.951433511414 1822.4055423120003 L 242.59743344858592 1822.4055423120003 L 242.59743344858592 1781.8439759640003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="258.9577678305859" y="1807.3268931120003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthZ Server – Requesting Party (AS-RqP)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 953.8405051026874 1781.8439759640003 L 1029.0611738666873 1781.8439759640003 L 1029.0611738666873 1822.4055423120003 L 953.8405051026874 1822.4055423120003 L 953.8405051026874 1781.8439759640003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="970.2008394846874" y="1807.3268931120003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1415.1835676015155 1781.8439759640003 L 1603.6375737678593 1781.8439759640003 L 1603.6375737678593 1822.4055423120003 L 1415.1835676015155 1822.4055423120003 L 1415.1835676015155 1781.8439759640003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1431.5439019835155" y="1807.3268931120003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1832.0933110085466 1781.8439759640003 L 2161.1139675655154 1781.8439759640003 L 2161.1139675655154 1822.4055423120003 L 1832.0933110085466 1822.4055423120003 L 1832.0933110085466 1781.8439759640003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1848.4536453905466" y="1807.3268931120003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthZ Server – Resource Owner (AS-RO)</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 116.78099330117188 80.972346204 L 695.1970893788281 80.972346204 L 708.7678736588281 94.543130484 L 708.7678736588281 160.889186964 L 116.78099330117188 160.889186964 L 116.78099330117188 80.972346204 M 695.1970893788281 80.972346204 L 695.1970893788281 94.543130484 L 708.7678736588281 94.543130484" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="137.89110218117185" y="102.082455084" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS-RqP:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="137.89110218117185" y="117.161104284" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports the token exchange extension of OAuth2 as an STS service</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="137.89110218117185" y="132.239753484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• publishes its metadata on a URL /.well-known/oauth-authorization-server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="137.89110218117185" y="147.318402684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• also acts as RqP's Identity Provider</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 537.6490496964843 183.507160764 L 1431.6818449928905 183.507160764 L 1445.2526292728905 197.077945044 L 1445.2526292728905 278.502650724 L 537.6490496964843 278.502650724 L 537.6490496964843 183.507160764 M 1431.6818449928905 183.507160764 L 1431.6818449928905 197.077945044 L 1445.2526292728905 197.077945044" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.7591585764843" y="204.61726964399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.7591585764843" y="219.69591884399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at AS-RqP as a public or confidential client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.7591585764843" y="234.77456804399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a Relying Party in respect of the RqP's Identity Provider in order to obtain an access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.7591585764843" y="249.85321724399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at AS-RO as a public or confidential client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.7591585764843" y="264.931866444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a token forwarder that forwards tokens between the RS and STS, and between the STS and AS-RO</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1208.2837992070313 301.120624524 L 1796.9665578823437 301.120624524 L 1810.5373421623437 314.691408804 L 1810.5373421623437 335.801517684 L 1208.2837992070313 335.801517684 L 1208.2837992070313 301.120624524 M 1796.9665578823437 301.120624524 L 1796.9665578823437 314.691408804 L 1810.5373421623437 314.691408804" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1229.3939080870311" y="322.23073340400003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RO has set up the RS, registers the resources at the AS-RO and sets policies</text></g><g><g><rect fill="white" stroke="none" x="1018.1939016011718" y="358.419491484" width="464.47360696703123" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1020.4556989811717" y="371.990275764" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Send HTTP request to the resource_uri with no access token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 991.4508394846874 378.021735444 L 1496.9958161766874 378.021735444" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1509.4105706846874,378.021735444) translate(-1509.4105706846874,-378.021735444)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1496.8450296846875 371.738964944 L 1509.4105706846874 378.021735444 L 1496.8450296846875 384.304505944 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1536.720313709375" y="400.639709244" width="432.57358255296873" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1536.720313709375" y="415.71835844400005" width="48.973595522939455" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1538.982111089375" y="414.21049352400007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Request a permission_ticket and resource_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1538.982111089375" y="429.28914272400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{PAT}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1509.4105706846874 435.320602404 L 1984.188884779031 435.320602404" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1996.603639287031,435.320602404) translate(-1996.603639287031,-435.320602404)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1984.038098287031 429.037831904 L 1996.603639287031 435.320602404 L 1984.038098287031 441.603372904 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1542.176849498828 457.938576204 L 2437.459644795234 457.938576204 L 2451.030429075234 471.509360484 L 2451.030429075234 598.170013764 L 1542.176849498828 598.170013764 L 1542.176849498828 457.938576204 M 2437.459644795234 457.938576204 L 2437.459644795234 471.509360484 L 2451.030429075234 471.509360484" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1563.2869583788279" y="479.0486850840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS-RO generates the permission_ticket (a JWT with a random NONCE value in the sub claim)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1563.2869583788279" y="494.1273342840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and the resource_claims_token which is bound to the permission_ticket through the permission_ticket sub claim hash.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1563.2869583788279" y="509.20598348400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">The resource_claims_token contains these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1563.2869583788279" y="524.284632684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{iss, aud, sub, exp, nbf}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1563.2869583788279" y="539.363281884" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">iss is the URI that identifies who issues the resource_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1563.2869583788279" y="554.441931084" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">aud is the URI that identifies the requested resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1563.2869583788279" y="569.520580284" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">sub is the permission_ticket sub claim hash computed as Base64URL-Encode(SHA256(permission_ticket{sub})</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1563.2869583788279" y="584.5992294839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">exp, nbf are the standard JWT claims)</text></g><g><g><rect fill="white" stroke="none" x="1527.2536389046875" y="620.7879875640001" width="413.8069199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1527.2536389046875" y="635.8666367640001" width="451.50693216234373" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1529.5154362846874" y="634.3587718440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Return the permission_ticket, resource_claims_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1529.5154362846874" y="649.4374210440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    issued_token_type = urn:ietf:params:oauth:token-type:jwt</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1996.603639287031 655.4688807240001 L 1521.8253251926874 655.4688807240001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1509.4105706846874,655.4688807240001) translate(-1509.4105706846874,-655.4688807240001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1521.9761116846873 649.1861102240001 L 1509.4105706846874 655.4688807240001 L 1521.9761116846873 661.751651224 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1009.2939077046874" y="678.0868545240002" width="482.27359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1009.2939077046874" y="693.1655037240001" width="451.50693216234373" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1011.5557050846874" y="691.6576388040002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return 401 with the permission_ticket, resource_claims_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1011.5557050846874" y="706.7362880040001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    issued_token_type = urn:ietf:params:oauth:token-type:jwt</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1509.4105706846874 712.7677476840001 L 1003.8655939926874 712.7677476840001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(991.4508394846874,712.7677476840001) translate(-991.4508394846874,-712.7677476840001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1004.0163804846875 706.4849771840002 L 991.4508394846874 712.7677476840001 L 1004.0163804846875 719.0505181840001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="430.6175017" y="735.3857214840002" width="462.7402695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="430.6175017" y="750.4643706840002" width="255.84026040941407" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="430.6175017" y="765.5430198840002" width="487.95691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="430.6175017" y="780.6216690840001" width="385.85693826585936" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="430.6175017" y="795.7003182840001" width="542.9902695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="430.6175017" y="810.7789674840001" width="306.70691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="430.6175017" y="825.857616684" width="456.29025735765623" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="432.87929908" y="748.9565057640002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Request an identity_claims_token (token exchange request)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="432.87929908" y="764.0351549640002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {grant_type = token-exchange,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="432.87929908" y="779.1138041640002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     requested_token_type = urn:ietf:params:oauth:token-type:jwt,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="432.87929908" y="794.1924533640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     subject_token = access_token_with_user_claims,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="432.87929908" y="809.2711025640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     subject_token_type = urn:ietf:params:oauth:token-type:access_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="432.87929908" y="824.3497517640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     actor_token = resource_claims_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="432.87929908" y="839.428400964" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     actor_token_type = urn:ietf:params:oauth:token-type:jwt}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 991.4508394846874 845.4598606440002 L 425.18918798799996 845.4598606440002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(412.77443347999997,845.4598606440002) translate(-412.77443347999997,-845.4598606440002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 425.33997447999997 839.1770901440002 L 412.77443347999997 845.4598606440002 L 425.33997447999997 851.7426311440001 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 224.83099635292967 908.7901872840001 L 587.1470863270703 908.7901872840001 L 600.7178706070703 922.3609715640001 L 600.7178706070703 988.7070280440001 L 224.83099635292967 988.7070280440001 L 224.83099635292967 908.7901872840001 M 587.1470863270703 908.7901872840001 L 587.1470863270703 922.3609715640001 L 600.7178706070703 922.3609715640001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="245.94110523292966" y="929.9002961640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. verify the subject_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="245.94110523292966" y="944.9789453640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. evaluate the subject_token claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="245.94110523292966" y="960.057594564" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. verify the resource_claims_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="245.94110523292966" y="975.136243764" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. evaluate the resource claims </text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 1033.9429756440002 L 804.43875808 1033.9429756440002 L 818.00954236 1047.5137599240002 L 818.00954236 1159.095764004 L 7.5393246000000005 1159.095764004 L 7.5393246000000005 1033.9429756440002 M 804.43875808 1033.9429756440002 L 804.43875808 1047.5137599240002 L 818.00954236 1047.5137599240002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="1055.053084524" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS-RqP generates the identity_claims_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="1070.131733724" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{iss, aud, sub, exp, nbf, act{sub}}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="1085.210382924" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">iss is the URI that identifies who issues the identity_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="1100.289032124" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">aud identifies the target service and it is the iss claim value extracted from the resource_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="1115.367681324" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">sub identifies the principal by email address and was extracted from the access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="1130.446330524" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="1145.5249797239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">act{sub} is the sub value extracted from the resource_claims_token</text></g><g><g><rect fill="white" stroke="none" x="451.9925017" y="1181.713737804" width="500.2402695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="451.9925017" y="1196.792387004" width="451.50693216234373" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="454.25429908" y="1195.284522084" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Return the identity_claims_token in the access_token parameter,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="454.25429908" y="1210.363171284" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    issued_token_type = urn:ietf:params:oauth:token-type:jwt</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 412.77443347999997 1216.394630964 L 979.0360849766874 1216.394630964" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(991.4508394846874,1216.394630964) translate(-991.4508394846874,-1216.394630964)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 978.8852984846874 1210.111860464 L 991.4508394846874 1216.394630964 L 978.8852984846874 1222.677401464 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1256.9487763564453" y="1239.0126047640001" width="316.27359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1256.9487763564453" y="1254.091253964" width="216.85692300707032" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1256.9487763564453" y="1269.169903164" width="222.95692911058595" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1256.9487763564453" y="1284.248552364" width="300.9069260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1256.9487763564453" y="1299.327201564" width="474.1569260588281" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1259.2105737364452" y="1252.5833890440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Request a Requesting Party Token (RPT)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1259.2105737364452" y="1267.662038244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {grant_type = uma-ticket,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1259.2105737364452" y="1282.740687444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     ticket = permission_ticket,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1259.2105737364452" y="1297.819336644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     claim_token = identity_claims_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1259.2105737364452" y="1312.897985844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     claim_token_format = urn:ietf:params:oauth:token-type:jwt}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 991.4508394846874 1318.9294455240001 L 1984.188884779031 1318.9294455240001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1996.603639287031,1318.9294455240001) translate(-1996.603639287031,-1318.9294455240001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1984.038098287031 1312.6466750240002 L 1996.603639287031 1318.9294455240001 L 1984.038098287031 1325.212216024 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1595.4018556023436 1382.2597721640002 L 2384.2346386917184 1382.2597721640002 L 2397.8054229717186 1395.8305564440002 L 2397.8054229717186 1477.2552621240002 L 1595.4018556023436 1477.2552621240002 L 1595.4018556023436 1382.2597721640002 M 2384.2346386917184 1382.2597721640002 L 2384.2346386917184 1395.8305564440002 L 2397.8054229717186 1395.8305564440002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1616.5119644823435" y="1403.369881044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. verify the permission ticket signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1616.5119644823435" y="1418.448530244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. evaluate the permission_ticket claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1616.5119644823435" y="1433.527179444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. verify the identity_claims_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1616.5119644823435" y="1448.605828644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. evaluate the identity claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1616.5119644823435" y="1463.684477844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. compare identity_claims_token{act{sub}} vs. Base64URL-Encode(SHA256(permission_ticket{sub}))</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1738.676864757617 1522.4912097240003 L 2240.959629536445 1522.4912097240003 L 2254.530413816445 1536.0619940040003 L 2254.530413816445 1587.3294012840004 L 1738.676864757617 1587.3294012840004 L 1738.676864757617 1522.4912097240003 M 2240.959629536445 1522.4912097240003 L 2240.959629536445 1536.0619940040003 L 2254.530413816445 1536.0619940040003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1759.786973637617" y="1543.6013186040004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS-RO generates the RPT with these additional claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1759.786973637617" y="1558.6799678040004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{permissions}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1759.786973637617" y="1573.7586170040004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">permissions, all permissions granted by the authorization server</text></g><g><g><rect fill="white" stroke="none" x="1327.432113758789" y="1609.9473750840004" width="333.1902512541406" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1329.693911138789" y="1623.5181593640004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Return the RPT, optionally a refresh_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1996.603639287031 1629.5496190440003 L 1003.8655939926874 1629.5496190440003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(991.4508394846874,1629.5496190440003) translate(-991.4508394846874,-1629.5496190440003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1004.0163804846875 1623.2668485440004 L 991.4508394846874 1629.5496190440003 L 1004.0163804846875 1635.8323895440003 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1111.8522420552733" y="1652.1675928440002" width="277.1569260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1111.8522420552733" y="1667.2462420440002" width="69.87359323412109" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1114.1140394352733" y="1665.7383771240002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. Send HTTP request to resource_uri</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1114.1140394352733" y="1680.8170263240002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {RPT}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 991.4508394846874 1686.8484860040003 L 1496.9958161766874 1686.8484860040003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1509.4105706846874,1686.8484860040003) translate(-1509.4105706846874,-1686.8484860040003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1496.8450296846875 1680.5657155040003 L 1509.4105706846874 1686.8484860040003 L 1496.8450296846875 1693.1312565040002 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1019.702248158789" y="1709.4664598040004" width="461.45691385179686" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1021.9640455387889" y="1723.0372440840003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10. Return HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1509.4105706846874 1729.0687037640002 L 1003.8655939926874 1729.0687037640002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(991.4508394846874,1729.0687037640002) translate(-991.4508394846874,-1729.0687037640002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1004.0163804846875 1722.7859332640003 L 991.4508394846874 1729.0687037640002 L 1004.0163804846875 1735.3514742640002 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 217.2916717529297 868.0778344440001 L 608.2571952070703 868.0778344440001 L 608.2571952070703 1011.3250018440001 L 217.2916717529297 1011.3250018440001 L 217.2916717529297 868.0778344440001 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 217.2916717529297 868.0778344440001 L 217.2916717529297 886.1722134840002 L 741.6489823599609 886.1722134840002 L 750.6961718799608 877.1250239640001 L 750.6961718799608 868.0778344440001 L 217.2916717529297 868.0778344440001" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="232.3703209529297" y="880.1407538040002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization assessment – evaluate the resource provenance / ownership</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1587.8625310023435 1341.5474193240002 L 2405.3447475717185 1341.5474193240002 L 2405.3447475717185 1499.8732359240003 L 1587.8625310023435 1499.8732359240003 L 1587.8625310023435 1341.5474193240002 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1587.8625310023435 1341.5474193240002 L 1587.8625310023435 1359.6417983640001 L 2136.119804988281 1359.6417983640001 L 2145.166994508281 1350.5946088440003 L 2145.166994508281 1341.5474193240002 L 1587.8625310023435 1341.5474193240002" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1602.9411802023435" y="1353.6103386840002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization assessment – evaluate the RqP identity provenance / ownership</text></g></g></g></svg>