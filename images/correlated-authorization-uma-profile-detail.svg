<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="2311" height="1792"><desc>participant%20%22AuthZ%20Server%20%E2%80%93%20Requesting%20Party%20(AS-RqP)%22%20as%20AS-RqP%0Aparticipant%20%22Client%22%20as%20Client%0Aparticipant%20%22Resource%20Server%20(RS)%22%20as%20RS%0Aparticipant%20%22AuthZ%20Server%20%E2%80%93%20Resource%20Owner%20(AS-RO)%22%20as%20AS-RO%0A%0Abottomparticipants%0A%0Anote%20over%20AS-RqP%3AAS-RqP%3A%5Cn%E2%80%A2%20supports%20the%20token%20exchange%20extension%20of%20OAuth2%2C%20as%20an%20STS%20service.%5Cn%E2%80%A2%20publishes%20its%20metadata%20on%20a%20URL%20%2F.well-known%2Foauth-authorization-server%5Cn%E2%80%A2%20also%20acts%20as%20RqP's%20Identity%20Provider%0Anote%20over%20Client%3AClient%3A%5Cn%E2%80%A2%20is%20registered%20at%20AS-RqP%20as%20a%20public%20or%20confidential%20client%5Cn%E2%80%A2%20acts%20as%20a%20Relying%20Party%20in%20a%20RqP's%20Identity%20Provider%20in%20order%20to%20obtain%20an%20an%20access_token_with_user_claims%5Cn%E2%80%A2%20is%20registered%20at%20AS-RO%20as%20a%20public%20or%20confidential%20client%0Anote%20over%20RS%3ARO%20has%20set%20up%20RS%20and%20registers%20his%20resource%20at%20AS-RO%20to%20get%20resource_uri%20and%20sets%20policies%5Cnto%20the%20resource%20sets%20with%20the%20authorization%20server%20to%20indicate%20who%20can%20access%20the%20resources.%0ARS%3C-Client%3A1.%20Send%20HTTP%20request%20to%20resource_uri%20with%20no%20access%20token%0ARS-%3EAS-RO%3A2.%20Request%20a%20permission%20ticket%20and%20resource%20claims%20token%5Cn%7BPAT%7D%0Anote%20over%20AS-RO%3A%20AS-RO%20generates%20the%20permission%20ticket%20itself%20(ticket%20is%20a%20random%20NONCE)%20and%20the%20resource%20claims%20token%2C%5Cnwhich%20is%20bound%20to%20the%20permission%20ticket%20through%20a%20permission%20ticket%20hash.%5CnThe%20resource%20claims%20token%20contains%20these%20claims%3A%5Cn%7Bissuer%2C%20ts%2C%20audience%2C%20resource_uri_hash%2C%20permission_ticket_hash%7D%5Cnissuer%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20resource%20claims%20token%5Cnts%20is%20the%20timestamp%20of%20when%20the%20permission%20ticket%20was%20created%5Cnaudience%20is%20the%20URI%20that%20identifies%20the%20resource%20server%5Cnresource_uri_hash%20%3D%20Base64URL-Encode(SHA256(resource_uri))%5Cnpermission_ticket_hash%20%3D%20Base64URL-Encode(SHA256(permission_ticket))%0ARS%3C-AS-RO%3A3.%20Return%20the%20permission%20ticket%20and%20resource%20claims%20token%0ARS-%3EClient%3A4.%20Return%20401%20with%20the%20permission%20ticket%20and%20resource%20claims%20token%0AAS-RqP%3C-Client%3A5.%20Request%20an%20identity%20claims%20token%20(token%20exchange%20request)%5Cn%20%20%20%20%7Bgrant_type%20%3D%20token-exchange%2C%5Cn%20%20%20%20%20resource%20%3D%20resource_uri%2C%5Cn%20%20%20%20%20scope%20%3D%20resource_claims_token%2C%5Cn%20%20%20%20%20subject_token%20%3D%20access_token_with_user_claims%2C%5Cn%20%20%20%20%20subject_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token%2C%5Cn%20%20%20%20%20requested_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%7D%0Agroup%20Trust%20assessment%20%E2%80%93%20evaluate%20the%20resource%20URI%20provenance%20%2F%20ownership%0Anote%20over%20AS-RqP%3A1.%20verify%20the%20resource_claims_token%20signature%5Cn2.%20extract%20resource_uri_hash%20claim%20from%20resource_claims_token%5Cn3.%20compare%20resource_uri_hash%20vs.%20Base64URL-Encode(SHA256(resource_uri))%5Cn4.%20evaluate%20the%20resource%20claims%20%0Aend%0Anote%20over%20AS-RqP%3AAS-RqP%20generates%20the%20identity%20claims%20token%2C%20which%20contains%20these%20claims%3A%5Cn%7Baudience%2C%20user_claims%2C%20permission_ticket_hash%7D%5Cnaudience%20%3D%20the%20iss%20claim%20value%20extracted%20from%20resource_claims_token%5Cnuser_claims%20are%20extracted%20from%20access_token_with_user_claims%5Cnpermission_ticket_hash%20is%20extracted%20from%20resource_claims_token%0AClient%3C-AS-RqP%3A6.%20Return%20the%20identity%20claims%20token%5Cn%20%20%20%20%7Bidentity_claims_token%7D%0A%0AClient-%3EAS-RO%3A7.%20Request%20a%20Requesting%20Party%20Token%20(RPT)%5Cn%20%20%20%20%7Bgrant_type%20%3D%20uma-ticket%2C%5Cn%20%20%20%20%20ticket%20%3D%20ticket%2C%5Cn%20%20%20%20%20claim_token%20%3D%20identity_claims_token%7D%0Agroup%20Trust%20assessment%20%E2%80%93%20evaluate%20the%20RqP%20identity%20provenance%20%2F%20ownership%0Anote%20over%20AS-RO%3A1.%20verify%20the%20permission_ticket%5Cn2.%20verify%20the%20audience%20claim%20from%20identity_claims_token%5Cn3.%20extract%20user_claims%20from%20identity_claims_token%5Cn4.%20select%20the%20email_address%20claim%20from%20user_claims%5Cn5.%20bootstrap%20discovery%20of%20AS-RqP%20url%20from%20email%20address%20via%20WebFinger%3B%5Cn%20%20%20%20if%20this%20doesn't%20work%2C%20build%20well-known%20url%20using%20domain%20part%20of%20email_address%5Cn6.%20compare%20AS-RqP%20url%20with%20the%20iss%20claim%20from%20resource_claims_token%5Cn7.%20verify%20the%20identity_claims_token%20signature%5Cn8.%20extract%20permission_ticket_hash%20claim%20from%20identity_claims_token%5Cn9.%20compare%20permission_ticket_hash%20vs.%20Base64URL-Encode(SHA256(permission_ticket))%5Cn10.%20evaluate%20the%20remaining%20identity%20claims%0Aend%0AClient%3C-AS-RO%3A8.%20Return%20RPT%2C%20optionally%20a%20refresh%20token%5Cn%20%20%20%20%7BRPT%7D%0ARS%3C-Client%3A9.%20Send%20HTTP%20request%20to%20resource_uri%5Cn%20%20%20%20%7BRPT%7D%0ARS-%3EClient%3A10.%20Return%20HTTP%20response%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="2311" height="1792"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 326.1780948870312 50.815047804 L 326.1780948870312 1739.6237582039996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 904.8545008917187 50.815047804 L 904.8545008917187 1739.6237582039996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1437.7475511835155 50.815047804 L 1437.7475511835155 1739.6237582039996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1902.173957188203 50.815047804 L 1902.173957188203 1739.6237582039996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 156.00109485561714 10.253481456000003 L 496.3550949184453 10.253481456000003 L 496.3550949184453 50.815047804 L 156.00109485561714 50.815047804 L 156.00109485561714 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="172.36142923761713" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthZ Server – Requesting Party (AS-RqP)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 867.2441665097186 10.253481456000003 L 942.4648352737187 10.253481456000003 L 942.4648352737187 50.815047804 L 867.2441665097186 50.815047804 L 867.2441665097186 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="883.6045008917187" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1343.5205481003436 10.253481456000003 L 1531.9745542666874 10.253481456000003 L 1531.9745542666874 50.815047804 L 1343.5205481003436 50.815047804 L 1343.5205481003436 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1359.8808824823436" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1737.6636289097187 10.253481456000003 L 2066.6842854666875 10.253481456000003 L 2066.6842854666875 50.815047804 L 1737.6636289097187 50.815047804 L 1737.6636289097187 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1754.0239632917187" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthZ Server – Resource Owner (AS-RO)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 156.00109485561714 1739.6237582039996 L 496.3550949184453 1739.6237582039996 L 496.3550949184453 1780.1853245519997 L 156.00109485561714 1780.1853245519997 L 156.00109485561714 1739.6237582039996 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="172.36142923761713" y="1765.1066753519997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthZ Server – Requesting Party (AS-RqP)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 867.2441665097186 1739.6237582039996 L 942.4648352737187 1739.6237582039996 L 942.4648352737187 1780.1853245519997 L 867.2441665097186 1780.1853245519997 L 867.2441665097186 1739.6237582039996 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="883.6045008917187" y="1765.1066753519997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1343.5205481003436 1739.6237582039996 L 1531.9745542666874 1739.6237582039996 L 1531.9745542666874 1780.1853245519997 L 1343.5205481003436 1780.1853245519997 L 1343.5205481003436 1739.6237582039996 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1359.8808824823436" y="1765.1066753519997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1737.6636289097187 1739.6237582039996 L 2066.6842854666875 1739.6237582039996 L 2066.6842854666875 1780.1853245519997 L 1737.6636289097187 1780.1853245519997 L 1737.6636289097187 1739.6237582039996 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1754.0239632917187" y="1765.1066753519997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthZ Server – Resource Owner (AS-RO)</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 30.184654708203098 80.972346204 L 608.6007507858593 80.972346204 L 622.1715350658593 94.543130484 L 622.1715350658593 160.889186964 L 30.184654708203098 160.889186964 L 30.184654708203098 80.972346204 M 608.6007507858593 80.972346204 L 608.6007507858593 94.543130484 L 622.1715350658593 94.543130484" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="51.29476358820307" y="102.082455084" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS-RqP:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="51.29476358820307" y="117.161104284" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports the token exchange extension of OAuth2, as an STS service.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="51.29476358820307" y="132.239753484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• publishes its metadata on a URL /.well-known/oauth-authorization-server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="51.29476358820307" y="147.318402684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• also acts as RqP's Identity Provider</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 486.1527172070312 183.507160764 L 1309.9855002964061 183.507160764 L 1323.5562845764061 197.077945044 L 1323.5562845764061 263.424001524 L 486.1527172070312 263.424001524 L 486.1527172070312 183.507160764 M 1309.9855002964061 183.507160764 L 1309.9855002964061 197.077945044 L 1323.5562845764061 197.077945044" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="507.26282608703116" y="204.617269644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="507.26282608703116" y="219.695918844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at AS-RqP as a public or confidential client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="507.26282608703116" y="234.774568044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a Relying Party in a RqP's Identity Provider in order to obtain an an access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="507.26282608703116" y="249.853217244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at AS-RO as a public or confidential client</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1078.6457736023438 286.041975324 L 1783.2785444846875 286.041975324 L 1796.8493287646875 299.612759604 L 1796.8493287646875 335.80151768400003 L 1078.6457736023438 335.80151768400003 L 1078.6457736023438 286.041975324 M 1783.2785444846875 286.041975324 L 1783.2785444846875 299.612759604 L 1796.8493287646875 299.612759604" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1099.7558824823436" y="307.15208420400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RO has set up RS and registers his resource at AS-RO to get resource_uri and sets policies</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1099.7558824823436" y="322.23073340400003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">to the resource sets with the authorization server to indicate who can access the resources.</text></g><g><g><rect fill="white" stroke="none" x="953.4392225541014" y="358.41949148400005" width="435.72360696703123" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="955.7010199341014" y="371.9902757640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Send HTTP request to resource_uri with no access token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 904.8545008917187 378.02173544400006 L 1425.3327966755155 378.02173544400006" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1437.7475511835155,378.02173544400006) translate(-1437.7475511835155,-378.02173544400006)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1425.1820101835156 371.73896494400003 L 1437.7475511835155 378.02173544400006 L 1425.1820101835156 384.3045059440001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1457.673962909375" y="400.6397092440001" width="424.57358255296873" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1457.673962909375" y="415.71835844400005" width="48.973595522939455" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1459.935760289375" y="414.21049352400007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Request a permission ticket and resource claims token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1459.935760289375" y="429.28914272400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{PAT}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1437.7475511835155 435.32060240400006 L 1889.759202680203 435.32060240400006" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1902.173957188203,435.32060240400006) translate(-1902.173957188203,-435.32060240400006)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1889.6084161882031 429.03783190400003 L 1902.173957188203 435.32060240400006 L 1889.6084161882031 441.6033729040001 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1500.0638483082032 457.938576204 L 2290.713281788203 457.938576204 L 2304.284066068203 471.509360484 L 2304.284066068203 613.248662964 L 1500.0638483082032 613.248662964 L 1500.0638483082032 457.938576204 M 2290.713281788203 457.938576204 L 2290.713281788203 471.509360484 L 2304.284066068203 471.509360484" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1521.173957188203" y="479.048685084" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS-RO generates the permission ticket itself (ticket is a random NONCE) and the resource claims token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1521.173957188203" y="494.12733428399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">which is bound to the permission ticket through a permission ticket hash.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1521.173957188203" y="509.20598348399994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">The resource claims token contains these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1521.173957188203" y="524.2846326839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{issuer, ts, audience, resource_uri_hash, permission_ticket_hash}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1521.173957188203" y="539.3632818839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">issuer is the URI that identifies who issues the resource claims token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1521.173957188203" y="554.4419310839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ts is the timestamp of when the permission ticket was created</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1521.173957188203" y="569.5205802839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">audience is the URI that identifies the resource server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1521.173957188203" y="584.5992294839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">resource_uri_hash = Base64URL-Encode(SHA256(resource_uri))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1521.173957188203" y="599.6778786839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">permission_ticket_hash = Base64URL-Encode(SHA256(permission_ticket))</text></g><g><g><rect fill="white" stroke="none" x="1455.5906194035156" y="635.866636764" width="428.7402695646875" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1457.8524167835155" y="649.437421044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Return the permission ticket and resource claims token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1902.173957188203 655.468880724 L 1450.1623056915155 655.468880724" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1437.7475511835155,655.468880724) translate(-1437.7475511835155,-655.468880724)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1450.3130921835154 649.186110224 L 1437.7475511835155 655.468880724 L 1450.3130921835154 661.7516512239999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="922.6975691117186" y="678.0868545239999" width="497.20691385179686" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="924.9593664917186" y="691.6576388039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return 401 with the permission ticket and resource claims token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1437.7475511835155 697.6890984839999 L 917.2692553997186 697.6890984839999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(904.8545008917187,697.6890984839999) translate(-904.8545008917187,-697.6890984839999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 917.4200418917187 691.406327984 L 904.8545008917187 697.6890984839999 L 917.4200418917187 703.9718689839999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="344.0211631070312" y="720.307072284" width="457.4069260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="344.0211631070312" y="735.385721484" width="255.84026040941407" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="344.0211631070312" y="750.464370684" width="207.90692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="344.0211631070312" y="765.5430198839999" width="263.57358255296873" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="344.0211631070312" y="780.6216690839999" width="385.85693826585936" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="344.0211631070312" y="795.7003182839999" width="542.9902695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="344.0211631070312" y="810.7789674839998" width="492.6236008635156" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.28296048703123" y="733.877856564" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Request an identity claims token (token exchange request)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.28296048703123" y="748.956505764" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {grant_type = token-exchange,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.28296048703123" y="764.035154964" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     resource = resource_uri,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.28296048703123" y="779.1138041639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     scope = resource_claims_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.28296048703123" y="794.1924533639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     subject_token = access_token_with_user_claims,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.28296048703123" y="809.2711025639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     subject_token_type = urn:ietf:params:oauth:token-type:access_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.28296048703123" y="824.3497517639998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     requested_token_type = urn:ietf:params:oauth:token-type:jwt}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 904.8545008917187 830.381211444 L 338.5928493950312 830.381211444" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(326.1780948870312,830.381211444) translate(-326.1780948870312,-830.381211444)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 338.7436358870312 824.098440944 L 326.1780948870312 830.381211444 L 338.7436358870312 836.6639819439999 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 22.617973799999973 893.7115380839999 L 616.1674316940624 893.7115380839999 L 629.7382159740624 907.2823223639999 L 629.7382159740624 973.6283788439999 L 22.617973799999973 973.6283788439999 L 22.617973799999973 893.7115380839999 M 616.1674316940624 893.7115380839999 L 616.1674316940624 907.2823223639999 L 629.7382159740624 907.2823223639999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="43.72808267999994" y="914.8216469639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. verify the resource_claims_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="43.72808267999994" y="929.9002961639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. extract resource_uri_hash claim from resource_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="43.72808267999994" y="944.9789453639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. compare resource_uri_hash vs. Base64URL-Encode(SHA256(resource_uri))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="43.72808267999994" y="960.0575945639998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. evaluate the resource claims </text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 35.14299821406247 1018.864326444 L 603.6424072799999 1018.864326444 L 617.2131915599999 1032.435110724 L 617.2131915599999 1113.859816404 L 35.14299821406247 1113.859816404 L 35.14299821406247 1018.864326444 M 603.6424072799999 1018.864326444 L 603.6424072799999 1032.435110724 L 617.2131915599999 1032.435110724" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="56.25310709406244" y="1039.9744353239998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS-RqP generates the identity claims token, which contains these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="56.25310709406244" y="1055.0530845239998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{audience, user_claims, permission_ticket_hash}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="56.25310709406244" y="1070.1317337239998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">audience = the iss claim value extracted from resource_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="56.25310709406244" y="1085.2103829239998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">user_claims are extracted from access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="56.25310709406244" y="1100.2890321239997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">permission_ticket_hash is extracted from resource_claims_token</text></g><g><g><rect fill="white" stroke="none" x="486.10449898349606" y="1136.4777902039998" width="258.8235978117578" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="486.10449898349606" y="1151.5564394039998" width="200.7235917082422" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="488.3662963634961" y="1150.0485744839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Return the identity claims token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="488.3662963634961" y="1165.1272236839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {identity_claims_token}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 326.1780948870312 1171.158683364 L 892.4397463837187 1171.158683364" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(904.8545008917187,1171.158683364) translate(-904.8545008917187,-1171.158683364)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 892.2889598917186 1164.875912864 L 904.8545008917187 1171.158683364 L 892.2889598917186 1177.4414538639999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1245.3774316599608" y="1193.7766571639997" width="316.27359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1245.3774316599608" y="1208.8553063639997" width="216.85692300707032" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1245.3774316599608" y="1223.9339555639997" width="135.45692911058595" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1245.3774316599608" y="1239.0126047639997" width="305.57358255296873" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1247.6392290399608" y="1207.3474414439997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Request a Requesting Party Token (RPT)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1247.6392290399608" y="1222.4260906439997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {grant_type = uma-ticket,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1247.6392290399608" y="1237.5047398439997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     ticket = ticket,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1247.6392290399608" y="1252.5833890439997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     claim_token = identity_claims_token}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 904.8545008917187 1258.6148487239998 L 1889.759202680203 1258.6148487239998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1902.173957188203,1258.6148487239998) translate(-1902.173957188203,-1258.6148487239998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1889.6084161882031 1252.3320782239998 L 1902.173957188203 1258.6148487239998 L 1889.6084161882031 1264.8976192239998 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1560.7138422046876 1321.9451753639996 L 2230.0632878917186 1321.9451753639996 L 2243.634072171719 1335.5159596439996 L 2243.634072171719 1507.4125605239997 L 1560.7138422046876 1507.4125605239997 L 1560.7138422046876 1321.9451753639996 M 2230.0632878917186 1321.9451753639996 L 2230.0632878917186 1335.5159596439996 L 2243.634072171719 1335.5159596439996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1581.8239510846875" y="1343.0552842439997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. verify the permission_ticket</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1581.8239510846875" y="1358.1339334439997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. verify the audience claim from identity_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1581.8239510846875" y="1373.2125826439997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. extract user_claims from identity_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1581.8239510846875" y="1388.2912318439996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. select the email_address claim from user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1581.8239510846875" y="1403.3698810439996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. bootstrap discovery of AS-RqP url from email address via WebFinger;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1581.8239510846875" y="1418.4485302439996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    if this doesn't work, build well-known url using domain part of email_address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1581.8239510846875" y="1433.5271794439996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. compare AS-RqP url with the iss claim from resource_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1581.8239510846875" y="1448.6058286439995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. verify the identity_claims_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1581.8239510846875" y="1463.6844778439995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. extract permission_ticket_hash claim from identity_claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1581.8239510846875" y="1478.7631270439995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. compare permission_ticket_hash vs. Base64URL-Encode(SHA256(permission_ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1581.8239510846875" y="1493.8417762439994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10. evaluate the remaining identity claims</text></g><g><g><rect fill="white" stroke="none" x="1252.6274316599608" y="1552.6485081239996" width="301.77359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1252.6274316599608" y="1567.7271573239996" width="69.87359323412109" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1254.8892290399608" y="1566.2192924039996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Return RPT, optionally a refresh token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1254.8892290399608" y="1581.2979416039996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {RPT}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1902.173957188203 1587.3294012839997 L 917.2692553997186 1587.3294012839997" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(904.8545008917187,1587.3294012839997) translate(-904.8545008917187,-1587.3294012839997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 917.4200418917187 1581.0466307839997 L 904.8545008917187 1587.3294012839997 L 917.4200418917187 1593.6121717839997 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1032.722563008203" y="1609.9473750839995" width="277.1569260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1032.722563008203" y="1625.0260242839995" width="69.87359323412109" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1034.984360388203" y="1623.5181593639995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. Send HTTP request to resource_uri</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1034.984360388203" y="1638.5968085639995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {RPT}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 904.8545008917187 1644.6282682439996 L 1425.3327966755155 1644.6282682439996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1437.7475511835155,1644.6282682439996) translate(-1437.7475511835155,-1644.6282682439996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1425.1820101835156 1638.3454977439997 L 1437.7475511835155 1644.6282682439996 L 1425.1820101835156 1650.9110387439996 Z"/></g></g><g><g><rect fill="white" stroke="none" x="942.9058973587889" y="1667.2462420439997" width="456.79025735765623" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="945.1676947387889" y="1680.8170263239997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10. Return HTTP response typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1437.7475511835155 1686.8484860039996 L 917.2692553997186 1686.8484860039996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(904.8545008917187,1686.8484860039996) translate(-904.8545008917187,-1686.8484860039996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 917.4200418917187 1680.5657155039996 L 904.8545008917187 1686.8484860039996 L 917.4200418917187 1693.1312565039996 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 15.078649199999973 852.9991852439999 L 637.2775405740624 852.9991852439999 L 637.2775405740624 996.2463526439999 L 15.078649199999973 996.2463526439999 L 15.078649199999973 852.9991852439999 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 15.078649199999973 852.9991852439999 L 15.078649199999973 871.093564284 L 509.8359537035156 871.093564284 L 518.8831432235156 862.0463747639999 L 518.8831432235156 852.9991852439999 L 15.078649199999973 852.9991852439999" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="30.157298399999974" y="865.062104604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Trust assessment – evaluate the resource URI provenance / ownership</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1553.1745176046875 1281.2328225239999 L 2251.1733967717187 1281.2328225239999 L 2251.1733967717187 1530.0305343239997 L 1553.1745176046875 1530.0305343239997 L 1553.1745176046875 1281.2328225239999 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1553.1745176046875 1281.2328225239999 L 1553.1745176046875 1299.3272015639998 L 2044.8151534070312 1299.3272015639998 L 2053.862342927031 1290.280012044 L 2053.862342927031 1281.2328225239999 L 1553.1745176046875 1281.2328225239999" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1568.2531668046875" y="1293.2957418839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Trust assessment – evaluate the RqP identity provenance / ownership</text></g></g></g></svg>